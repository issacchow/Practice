# 内存诊断
## 查看占用cpu和内存最高的线程
> top -h -p {pid}
[  打开Data列: 按f建，通过空格选择显示，方向右键控制列的顺序 ]

输出一次指定jvm进程的所有线程信息
> top -p 15234 -H -b -n 1


## 查看指定内存
> pidstat -p {pid} 1
(等同 pidstat -p {pid} -u 1)



## iostat查看
> iostat -x -c 1





# JVM审查

## 查看内存示例数量, 并按指定列排序
> jmap -histor:live {pid} | sort -n -b -k {列的索引位置,从1开始,一般2或3} | less

## 查看gc过程
> jstat -gcutil -h 20 -t {jvmid} 1s
```
-h 参数用于控制每输出多少行记录后输出一个列头
-t 用于显示递增时间
```

## 查看各个内存空间占用情况
> jmap -heap {pid}




# MySql数据库
0.列表显示方式
> 在所有命令末尾，分号之前，增加\G, 如: show tables\G;



1.查看运行状态
> show status;
or
> show status like 'innodb%'
or
> 接使用Mywork Bentch

2.查看表状态信息 
> show table status like '表';

3.查看表的索引 
> show index from 表;

4.查看当前线程 
> show processlist;

5.查看当前实例基本信息
> status;

6.查看当前状态信息(包括线程统计)
> show status;

6.1.查看线程情况
> show status like '%thread%';

6.2.查看innodb情况
> show status like '%innodb%';

6.3.查看当前连接数
> show status like '%connection%'

7.查看变量配置
> show variables;

8.显示捕捉状态
```
set profiling=1;
select * from user;
set profiling=0;
```




# 判断磁盘IO

## 判断io最高的线程

> iotop
显示每秒io速度

> iotop -a  
显示累计io数量 

## 查看进程读写速度
> pidstat -d -p {pid} 1

## 查看所有读写情况
> pidstat -d 1

## 查看整体io情况
> iostat -x -d 1

主要指标:
- await: 大于10ms已经是出现很慢了,一般少于5ms


# 网络IO诊断
## sar工具
1.查看tcp
> sar -n TCP 1

2.查看磁盘负载,包括tps,rps(每次请求读次数),wps(每秒请求写的次数)
> sar -b 1

3.查看网络设备IO情况
> sar -n DEV 1



# 手动调用响应速度测试
curl http://172.25.2.160:6666/search --data-raw '{"page":1}' -H 'Content-Type: application/json; charset=utf8' -w "total ==> %{time_total}

